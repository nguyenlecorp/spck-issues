!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","../parser/cssNodes","vscode-languageserver-types","../parser/cssSymbolScope","../services/languageFacts","vscode-nls"],e)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("../parser/cssNodes"),l=e("vscode-languageserver-types"),d=e("../parser/cssSymbolScope"),f=e("../services/languageFacts"),a=e("vscode-nls").loadMessageBundle(),n=function(){function e(){}return e.prototype.findDefinition=function(e,t,n){var r=new d.Symbols(n),o=e.offsetAt(t),a=s.getNodeAtOffset(n,o);if(!a)return null;var i=r.findSymbolFromNode(a);return i?{uri:e.uri,range:p(i.node,e)}:null},e.prototype.findReferences=function(t,e,n){return this.findDocumentHighlights(t,e,n).map(function(e){return{uri:t.uri,range:e.range}})},e.prototype.findDocumentHighlights=function(t,e,n){var r=[],o=t.offsetAt(e),a=s.getNodeAtOffset(n,o);if(!a||a.type===s.NodeType.Stylesheet||a.type===s.NodeType.Declarations)return r;var i=new d.Symbols(n),u=i.findSymbolFromNode(a),c=a.getText();return n.accept(function(e){if(u){if(i.matchesSymbol(e,u))return r.push({kind:g(e),range:p(e,t)}),!1}else a.type===e.type&&a.length===e.length&&c===e.getText()&&r.push({kind:g(e),range:p(e,t)});return!0}),r},e.prototype.findDocumentSymbols=function(r,e){var o=[];return e.accept(function(e){var t={name:null,kind:l.SymbolKind.Class,location:null},n=e;return e instanceof s.Selector?(t.name=e.getText(),n=e.findParent(s.NodeType.Ruleset)):e instanceof s.VariableDeclaration?(t.name=e.getName(),t.kind=l.SymbolKind.Variable):e instanceof s.MixinDeclaration?(t.name=e.getName(),t.kind=l.SymbolKind.Method):e instanceof s.FunctionDeclaration?(t.name=e.getName(),t.kind=l.SymbolKind.Function):e instanceof s.Keyframe?t.name=a("literal.keyframes","@keyframes {0}",e.getName()):e instanceof s.FontFace&&(t.name=a("literal.fontface","@font-face")),t.name&&(t.location=l.Location.create(r.uri,p(n,r)),o.push(t)),!0}),o},e.prototype.findDocumentColors=function(n,e){var r=[];return e.accept(function(e){var t=function(e,t){var n=f.getColorValue(e);if(n){var r=p(e,t);return{color:n,range:r}}return null}(e,n);return t&&r.push(t),!0}),r},e.prototype.getColorPresentations=function(e,t,n,r){var o,a=[],i=Math.round(255*n.red),u=Math.round(255*n.green),c=Math.round(255*n.blue);o=1===n.alpha?"rgb("+i+", "+u+", "+c+")":"rgba("+i+", "+u+", "+c+", "+n.alpha+")",a.push({label:o,textEdit:l.TextEdit.replace(r,o)}),o=1===n.alpha?"#"+m(i)+m(u)+m(c):"#"+m(i)+m(u)+m(c)+m(Math.round(255*n.alpha)),a.push({label:o,textEdit:l.TextEdit.replace(r,o)});var s=f.hslFromColor(n);return o=1===s.a?"hsl("+s.h+", "+Math.round(100*s.s)+"%, "+Math.round(100*s.l)+"%)":"hsla("+s.h+", "+Math.round(100*s.s)+"%, "+Math.round(100*s.l)+"%, "+s.a+")",a.push({label:o,textEdit:l.TextEdit.replace(r,o)}),a},e.prototype.doRename=function(e,t,n,r){var o,a=this.findDocumentHighlights(e,t,r).map(function(e){return l.TextEdit.replace(e.range,n)});return{changes:(o={},o[e.uri]=a,o)}},e}();function p(e,t){return l.Range.create(t.positionAt(e.offset),t.positionAt(e.end))}function g(e){if(e.type===s.NodeType.Selector)return l.DocumentHighlightKind.Write;if(e instanceof s.Identifier&&e.parent&&e.parent instanceof s.Property&&e.isCustomProperty)return l.DocumentHighlightKind.Write;if(e.parent)switch(e.parent.type){case s.NodeType.FunctionDeclaration:case s.NodeType.MixinDeclaration:case s.NodeType.Keyframe:case s.NodeType.VariableDeclaration:case s.NodeType.FunctionParameter:return l.DocumentHighlightKind.Write}return l.DocumentHighlightKind.Read}function m(e){var t=e.toString(16);return 2!==t.length?"0"+t:t}t.CSSNavigation=n});