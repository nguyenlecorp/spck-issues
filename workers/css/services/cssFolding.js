!function(e){if("object"==typeof module&&"object"==typeof module.exports){var n=e(require,exports);void 0!==n&&(module.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../parser/cssScanner","../parser/scssScanner","../parser/lessScanner"],e)}((function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../parser/cssScanner"),t=e("../parser/scssScanner"),i=e("../parser/lessScanner");function s(e,n){if(0===e.length)return null;for(var r=e.length-1;r>=0;r--)if(e[r].type===n&&e[r].isStart)return e.splice(r,1)[0];return null}n.getFoldingRanges=function(e,n){return function(e,n){var r=n&&n.rangeLimit||Number.MAX_VALUE,t=e.sort((function(e,n){var r=e.startLine-n.startLine;return 0===r&&(r=e.endLine-n.endLine),r})),i=[],s=-1;return t.forEach((function(e){e.startLine<s&&s<e.endLine||(i.push(e),s=e.endLine)})),i.length<r?i:i.slice(0,r)}(function(e){function n(n){return e.positionAt(n.offset).line}function a(n){return e.positionAt(n.offset+n.len).line}var o=[],c=[],u=function(){switch(e.languageId){case"scss":return new t.SCSSScanner;case"less":return new i.LESSScanner;default:return new r.Scanner}}();u.ignoreComment=!1,u.setSource(e.getText());var l,f=u.scan(),p=function(){switch(f.type){case r.TokenType.CurlyL:case t.InterpolationFunction:c.push({line:n(f),type:"brace",isStart:!0});break;case r.TokenType.CurlyR:if(0!==c.length){if(!(g=s(c,"brace")))break;var i=a(f);"brace"===g.type&&(a(l)!==i&&i--,g.line!==i&&o.push({startLine:g.line,endLine:i,kind:void 0}))}break;case r.TokenType.Comment:var p=function(e){return"#region"===e?{line:n(f),type:"comment",isStart:!0}:{line:a(f),type:"comment",isStart:!1}},d=function(n){var r=n.text.match(/^\s*\/\*\s*(#region|#endregion)\b\s*(.*?)\s*\*\//);if(r)return p(r[1]);if("scss"===e.languageId||"less"===e.languageId){var t=n.text.match(/^\s*\/\/\s*(#region|#endregion)\b\s*(.*?)\s*/);if(t)return p(t[1])}return null}(f);if(d)if(d.isStart)c.push(d);else{var g;if(!(g=s(c,"comment")))break;"comment"===g.type&&g.line!==d.line&&o.push({startLine:g.line,endLine:d.line,kind:"region"})}else{var m=function(e,r){var t=n(e),i=a(e);return t!==i?{startLine:t,endLine:i,kind:r}:null}(f,"comment");m&&o.push(m)}}l=f,f=u.scan()};for(;f.type!==r.TokenType.EOF;)p();return o}(e),n)}}));