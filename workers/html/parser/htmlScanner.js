!function(t){if("object"==typeof module&&"object"==typeof module.exports){var e=t(require,exports);void 0!==e&&(module.exports=e)}else"function"==typeof define&&define.amd&&define(["require","exports","vscode-nls"],t)}((function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=t("vscode-nls").loadMessageBundle();!function(t){t[t.StartCommentTag=0]="StartCommentTag",t[t.Comment=1]="Comment",t[t.EndCommentTag=2]="EndCommentTag",t[t.StartTagOpen=3]="StartTagOpen",t[t.StartTagClose=4]="StartTagClose",t[t.StartTagSelfClose=5]="StartTagSelfClose",t[t.StartTag=6]="StartTag",t[t.EndTagOpen=7]="EndTagOpen",t[t.EndTagClose=8]="EndTagClose",t[t.EndTag=9]="EndTag",t[t.DelimiterAssign=10]="DelimiterAssign",t[t.AttributeName=11]="AttributeName",t[t.AttributeValue=12]="AttributeValue",t[t.StartDoctypeTag=13]="StartDoctypeTag",t[t.Doctype=14]="Doctype",t[t.EndDoctypeTag=15]="EndDoctypeTag",t[t.Content=16]="Content",t[t.Whitespace=17]="Whitespace",t[t.Unknown=18]="Unknown",t[t.Script=19]="Script",t[t.Styles=20]="Styles",t[t.EOS=21]="EOS"}(n=e.TokenType||(e.TokenType={}));var r,o=function(){function t(t,e){this.source=t,this.len=t.length,this.position=e}return t.prototype.eos=function(){return this.len<=this.position},t.prototype.getSource=function(){return this.source},t.prototype.pos=function(){return this.position},t.prototype.goBackTo=function(t){this.position=t},t.prototype.goBack=function(t){this.position-=t},t.prototype.advance=function(t){this.position+=t},t.prototype.goToEnd=function(){this.position=this.source.length},t.prototype.nextChar=function(){return this.source.charCodeAt(this.position++)||0},t.prototype.peekChar=function(t){return void 0===t&&(t=0),this.source.charCodeAt(this.position+t)||0},t.prototype.advanceIfChar=function(t){return t===this.source.charCodeAt(this.position)&&(this.position++,!0)},t.prototype.advanceIfChars=function(t){var e;if(this.position+t.length>this.source.length)return!1;for(e=0;e<t.length;e++)if(this.source.charCodeAt(this.position+e)!==t[e])return!1;return this.advance(e),!0},t.prototype.advanceIfRegExp=function(t){var e=this.source.substr(this.position).match(t);return e?(this.position=this.position+e.index+e[0].length,e[0]):""},t.prototype.advanceUntilRegExp=function(t){var e=this.source.substr(this.position).match(t);return e?(this.position=this.position+e.index,e[0]):(this.goToEnd(),"")},t.prototype.advanceUntilChar=function(t){for(;this.position<this.source.length;){if(this.source.charCodeAt(this.position)===t)return!0;this.advance(1)}return!1},t.prototype.advanceUntilChars=function(t){for(;this.position+t.length<=this.source.length;){for(var e=0;e<t.length&&this.source.charCodeAt(this.position+e)===t[e];e++);if(e===t.length)return!0;this.advance(1)}return this.goToEnd(),!1},t.prototype.skipWhitespace=function(){return this.advanceWhileChar((function(t){return t===T||t===v||t===f||t===l||t===C}))>0},t.prototype.advanceWhileChar=function(t){for(var e=this.position;this.position<this.len&&t(this.source.charCodeAt(this.position));)this.position++;return this.position-e},t}(),a="!".charCodeAt(0),s="-".charCodeAt(0),c="<".charCodeAt(0),h=">".charCodeAt(0),p="/".charCodeAt(0),u="=".charCodeAt(0),d='"'.charCodeAt(0),g="'".charCodeAt(0),f="\n".charCodeAt(0),C="\r".charCodeAt(0),l="\f".charCodeAt(0),T=" ".charCodeAt(0),v="\t".charCodeAt(0);!function(t){t[t.WithinContent=0]="WithinContent",t[t.AfterOpeningStartTag=1]="AfterOpeningStartTag",t[t.AfterOpeningEndTag=2]="AfterOpeningEndTag",t[t.WithinDoctype=3]="WithinDoctype",t[t.WithinTag=4]="WithinTag",t[t.WithinEndTag=5]="WithinEndTag",t[t.WithinComment=6]="WithinComment",t[t.WithinScriptContent=7]="WithinScriptContent",t[t.WithinStyleContent=8]="WithinStyleContent",t[t.AfterAttributeName=9]="AfterAttributeName",t[t.BeforeAttributeValue=10]="BeforeAttributeValue"}(r=e.ScannerState||(e.ScannerState={}));var W={"text/x-handlebars-template":!0};e.createScanner=function(t,e,f){void 0===e&&(e=0),void 0===f&&(f=r.WithinContent);var C,l,T,v,S,m=new o(t,e),y=f,A=0,E=n.Unknown;function x(){return m.advanceIfRegExp(/^[_:\w][_:\w-.\d]*/).toLowerCase()}function k(t,e,n){return E=e,A=t,C=n,e}return{scan:function(){var t=m.pos(),e=y,o=function t(){var e=m.pos();if(m.eos())return k(e,n.EOS);var o;switch(y){case r.WithinComment:return m.advanceIfChars([s,s,h])?(y=r.WithinContent,k(e,n.EndCommentTag)):(m.advanceUntilChars([s,s,h]),k(e,n.Comment));case r.WithinDoctype:return m.advanceIfChar(h)?(y=r.WithinContent,k(e,n.EndDoctypeTag)):(m.advanceUntilChar(h),k(e,n.Doctype));case r.WithinContent:if(m.advanceIfChar(c)){if(!m.eos()&&m.peekChar()===a){if(m.advanceIfChars([a,s,s]))return y=r.WithinComment,k(e,n.StartCommentTag);if(m.advanceIfRegExp(/^!doctype/i))return y=r.WithinDoctype,k(e,n.StartDoctypeTag)}return m.advanceIfChar(p)?(y=r.AfterOpeningEndTag,k(e,n.EndTagOpen)):(y=r.AfterOpeningStartTag,k(e,n.StartTagOpen))}return m.advanceUntilChar(c),k(e,n.Content);case r.AfterOpeningEndTag:return x().length>0?(y=r.WithinEndTag,k(e,n.EndTag)):m.skipWhitespace()?k(e,n.Whitespace,i("error.unexpectedWhitespace","Tag name must directly follow the open bracket.")):(y=r.WithinEndTag,m.advanceUntilChar(h),e<m.pos()?k(e,n.Unknown,i("error.endTagNameExpected","End tag name expected.")):t());case r.WithinEndTag:if(m.skipWhitespace())return k(e,n.Whitespace);if(m.advanceIfChar(h))return y=r.WithinContent,k(e,n.EndTagClose);o=i("error.tagNameExpected","Closing bracket expected.");break;case r.AfterOpeningStartTag:return T=x(),S=void 0,v=void 0,T.length>0?(l=!1,y=r.WithinTag,k(e,n.StartTag)):m.skipWhitespace()?k(e,n.Whitespace,i("error.unexpectedWhitespace","Tag name must directly follow the open bracket.")):(y=r.WithinTag,m.advanceUntilChar(h),e<m.pos()?k(e,n.Unknown,i("error.startTagNameExpected","Start tag name expected.")):t());case r.WithinTag:return m.skipWhitespace()?(l=!0,k(e,n.Whitespace)):l&&(v=m.advanceIfRegExp(/^[^\s"'>/=\x00-\x0F\x7F\x80-\x9F]*/).toLowerCase()).length>0?(y=r.AfterAttributeName,l=!1,k(e,n.AttributeName)):m.advanceIfChars([p,h])?(y=r.WithinContent,k(e,n.StartTagSelfClose)):m.advanceIfChar(h)?(y="script"===T?S&&W[S]?r.WithinContent:r.WithinScriptContent:"style"===T?r.WithinStyleContent:r.WithinContent,k(e,n.StartTagClose)):(m.advance(1),k(e,n.Unknown,i("error.unexpectedCharacterInTag","Unexpected character in tag.")));case r.AfterAttributeName:return m.skipWhitespace()?(l=!0,k(e,n.Whitespace)):m.advanceIfChar(u)?(y=r.BeforeAttributeValue,k(e,n.DelimiterAssign)):(y=r.WithinTag,t());case r.BeforeAttributeValue:if(m.skipWhitespace())return k(e,n.Whitespace);var f=m.advanceIfRegExp(/^[^\s"'`=<>\/]+/);if(f.length>0)return"type"===v&&(S=f),y=r.WithinTag,l=!1,k(e,n.AttributeValue);var C=m.peekChar();return C===g||C===d?(m.advance(1),m.advanceUntilChar(C)&&m.advance(1),"type"===v&&(S=m.getSource().substring(e+1,m.pos()-1)),y=r.WithinTag,l=!1,k(e,n.AttributeValue)):(y=r.WithinTag,l=!1,t());case r.WithinScriptContent:for(var A=1;!m.eos();){var E=m.advanceIfRegExp(/<!--|-->|<\/?script\s*\/?>?/i);if(0===E.length)return m.goToEnd(),k(e,n.Script);if("\x3c!--"===E)1===A&&(A=2);else if("--\x3e"===E)A=1;else if("/"!==E[1])2===A&&(A=3);else{if(3!==A){m.goBack(E.length);break}A=2}}return y=r.WithinContent,e<m.pos()?k(e,n.Script):t();case r.WithinStyleContent:return m.advanceUntilRegExp(/<\/style/i),y=r.WithinContent,e<m.pos()?k(e,n.Styles):t()}m.advance(1);y=r.WithinContent;return k(e,n.Unknown,o)}();return o!==n.EOS&&t===m.pos()?(console.log("Scanner.scan has not advanced at offset "+t+", state before: "+e+" after: "+y),m.advance(1),k(t,n.Unknown)):o},getTokenType:function(){return E},getTokenOffset:function(){return A},getTokenLength:function(){return m.pos()-A},getTokenEnd:function(){return m.pos()},getTokenText:function(){return m.getSource().substring(A,m.pos())},getScannerState:function(){return y},getTokenError:function(){return C}}}}));