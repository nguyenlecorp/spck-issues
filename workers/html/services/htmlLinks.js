!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","../parser/htmlScanner","vscode-languageserver-types","../utils/strings","vscode-uri"],e)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("../parser/htmlScanner"),n=e("vscode-languageserver-types"),s=e("../utils/strings"),a=e("vscode-uri");function o(e,t){var r=e[0];return r!==e[e.length-1]||"'"!==r&&'"'!==r||(e=e.substr(1,e.length-2)),"razor"===t&&"~"===e[0]&&(e=e.substr(1)),e}function i(e,t,r,i,u,c){var l=o(r,e.languageId);if(!function(e,t){if(!e.length)return!1;if("handlebars"===t&&/{{.*}}/.test(e))return!1;if("razor"===t&&/@/.test(e))return!1;try{return!!a.default.parse(e)}catch(e){return!1}}(l,e.languageId))return null;l.length<r.length&&(i++,u--);var f=function(e,t,r,n){return/^\s*javascript\:/i.test(t)||/^\s*\#/i.test(t)||/[\n\r]/.test(t)?null:(t=t.replace(/^\s*/g,""),/^https?:\/\//i.test(t)||/^file:\/\//i.test(t)?t:/^\/\//i.test(t)?(s.startsWith(e,"https://")?"https":"http")+":"+t.replace(/^\s*/g,""):r?r.resolveReference(t,n||e):t)}(e.uri,l,t,c);return f&&function(e){try{return a.default.parse(e),!0}catch(e){return!1}}(f)?{range:n.Range.create(e.positionAt(i),e.positionAt(u)),target:f}:null}t.findDocumentLinks=function(e,t){for(var n=[],s=r.createScanner(e.getText(),0),a=s.scan(),u=!1,c=!1,l=void 0;a!==r.TokenType.EOS;){switch(a){case r.TokenType.StartTag:if(!l)c="base"===s.getTokenText().toLowerCase();break;case r.TokenType.AttributeName:var f=s.getTokenText().toLowerCase();u="src"===f||"href"===f;break;case r.TokenType.AttributeValue:if(u){var g=s.getTokenText();if(!c){var p=i(e,t,g,s.getTokenOffset(),s.getTokenEnd(),l);p&&n.push(p)}c&&void 0===l&&(l=o(g,e.languageId))&&t&&(l=t.resolveReference(l,e.uri)),c=!1,u=!1}}a=s.scan()}return n}}));