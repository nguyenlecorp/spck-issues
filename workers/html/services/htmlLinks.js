!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","../parser/htmlScanner","vscode-languageserver-types","../utils/strings","vscode-uri"],e)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=e("../parser/htmlScanner"),g=e("vscode-languageserver-types"),p=e("../utils/strings"),d=e("vscode-uri");function v(e,t){var r=e[0];return r!==e[e.length-1]||"'"!==r&&'"'!==r||(e=e.substr(1,e.length-2)),"razor"===t&&"~"===e[0]&&(e=e.substr(1)),e}function h(e,t,r,n,s,a){var o=v(r,e.languageId);if(!function(e,t){if(!e.length)return!1;if("handlebars"===t&&/{{.*}}/.test(e))return!1;if("razor"===t&&/@/.test(e))return!1;try{return!!d.default.parse(e)}catch(e){return!1}}(o,e.languageId))return null;o.length<r.length&&(n++,s--);var i,u,c,l,f=(i=e.uri,c=t,l=a,/^\s*javascript\:/i.test(u=o)||/^\s*\#/i.test(u)||/[\n\r]/.test(u)?null:(u=u.replace(/^\s*/g,""),/^https?:\/\//i.test(u)||/^file:\/\//i.test(u)?u:/^\/\//i.test(u)?(p.startsWith(i,"https://")?"https":"http")+":"+u.replace(/^\s*/g,""):c?c.resolveReference(u,l||i):u));return f&&function(e){try{return d.default.parse(e),!0}catch(e){return!1}}(f)?{range:g.Range.create(e.positionAt(n),e.positionAt(s)),target:f}:null}t.findDocumentLinks=function(e,t){for(var r=[],n=f.createScanner(e.getText(),0),s=n.scan(),a=!1,o=!1,i=void 0;s!==f.TokenType.EOS;){switch(s){case f.TokenType.StartTag:i||(o="base"===n.getTokenText().toLowerCase());break;case f.TokenType.AttributeName:var u=n.getTokenText().toLowerCase();a="src"===u||"href"===u;break;case f.TokenType.AttributeValue:if(a){var c=n.getTokenText();if(!o){var l=h(e,t,c,n.getTokenOffset(),n.getTokenEnd(),i);l&&r.push(l)}o&&void 0===i&&(i=v(c,e.languageId))&&t&&(i=t.resolveReference(i,e.uri)),a=o=!1}}s=n.scan()}return r}});